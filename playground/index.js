!function(n){"function"==typeof define&&define.amd?define(n):n()}(function(){"use strict";var r,o,t,i=(r=console.log,o=['font-family: "Microsoft YaHei", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";',"color:white;","font-size:12px;","maring:5px 0;","background:yellowgreen;"],t=["color:black;","font-size:12px;"],function(n,e){r.call(r,"%c "+n+" %c "+e,o.join(""),t.join(""))}),n=(e.prototype.add=function(r,o){this.transactionList.push(function(n){var e=n.transaction([r],"readwrite").objectStore(r).add(o);e.onsuccess=function(n){console.log("数据写入成功")},e.onerror=function(n){console.warn(n),console.log("数据写入失败")}})},e.prototype.read=function(e){this.transactionList.push(function(n){n.transaction([e]).objectStore(e).openCursor().onsuccess=function(n){var e=n.target.result;e?(console.log(e.value),e.continue()):console.log("没有更多数据了！")}})},e),a=function(n,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,e){n.__proto__=e}||function(n,e){for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r])})(n,e)};function e(n,e){void 0===e&&(e=1);var r=this,o=indexedDB.open(n,e);this.transactionList=[],o.onerror=function(){i("[ MonitorSDK ]","数据库打开报错")},o.onsuccess=function(){i("[ MonitorSDK ]","数据库打开成功"),r.transactionList.forEach(function(n){return n(o.result)})},o.onupgradeneeded=function(n){var e=n.target.result;e.objectStoreNames.contains("error")||e.createObjectStore("error",{keyPath:"trackId",autoIncrement:!0})}}function s(n){this.userId=n.userId,this.timeStamp=n.timeStamp,this.mainType=n.mainType,this.device=n.device,this.currentUrl=n.currentUrl,this.refererUrl=n.refererUrl,this.pageInfo=n.pageInfo,this.appVersion=n.appVersion,this.apiVersion=n.apiVersion}var c,f,d,u,p,l,g,m,w=(a(g=function(n){var e=l.call(this,n)||this;return e.data=n.data,e},m=l=s),g.prototype=null===m?Object.create(m):(v.prototype=m.prototype,new v),new n("monitor")),h=(new Worker("./worker.js"),{db:w,data:new s({userId:"AAAA",device:{os:function(){var n=navigator.userAgent,e="Win32"==navigator.platform||"Windows"==navigator.platform,r="Mac68K"==navigator.platform||"MacPPC"==navigator.platform||"Macintosh"==navigator.platform||"MacIntel"==navigator.platform;if(r)return"Mac";if("X11"==navigator.platform&&!e&&!r)return"Unix";if(-1<String(navigator.platform).indexOf("Linux"))return"Linux";if(e){if(-1<n.indexOf("Windows NT 5.0")||-1<n.indexOf("Windows 2000"))return"Win2000";if(-1<n.indexOf("Windows NT 5.1")||-1<n.indexOf("Windows XP"))return"WinXP";if(-1<n.indexOf("Windows NT 5.2")||-1<n.indexOf("Windows 2003"))return"Win2003";if(-1<n.indexOf("Windows NT 6.0")||-1<n.indexOf("Windows Vista"))return"WinVista";if(-1<n.indexOf("Windows NT 6.1")||-1<n.indexOf("Windows 7"))return"Win7";if(-1<n.indexOf("Windows NT 10")||-1<n.indexOf("Windows 10"))return"Win10"}return"other"}(),browser:(d=[(c="undefined"!=typeof window&&window.navigator.userAgent.toLowerCase())&&/msie|trident/.test(c),f=c&&0<c.indexOf("edge/"),c&&/chrome\/\d+/.test(c)&&!f,c&&(-1<c.indexOf("opera")||-1<c.indexOf("opr")),c&&-1<c.indexOf("safari")&&-1===c.indexOf("chrome"),c&&0<c.indexOf("mqqbrowser"),c&&-1<c.indexOf("firefox"),c&&0<c.indexOf("ucbrowser/"),c&&0<c.indexOf("baiduboxapp"),c&&0<c.indexOf("android"),c&&/iphone|ipad|ipod|ios/.test(c)],(u=["IE","Edge","Chrome","Opera","Safari","QQ","FF","UC","Baidu","Android","IOS"].map(function(n){return{type:n,UA:c}}))[p=d.map(function(n,e){if(n)return e}).filter(Boolean)[0]]?u[p]:{type:"unknow",UA:c})},appVersion:1,apiVersion:1})});function v(){this.constructor=g}[function(n){var e=console.error;console.error=function(n){return console.log(n),e.call(this,arguments)}},function(u){window.addEventListener("error",function(n){var e;if(n.cancelable){var r=n.lineno,o=n.filename,t=n.timeStamp,i=n.error;e={lineno:r,filename:o,timeStamp:t,message:i?i.message:n.message,stack:i?i.stack:""}}else{var a=n.target,s=a.localName,c=a.href,f=a.src;e={resourceType:s,sourceUrl:"link"===s?c:f}}var d=Object.assign(function n(e,r){if(void 0===r&&(r=new Map),"object"==typeof e){if(r.has(e))return r.get(e);var o=Array.isArray(e)?[]:{};for(var t in r.set(e,o),e)o[t]="object"==typeof e[t]?n(e[t],r):e[t];return o}}(u.data),{timeStamp:(new Date).toString(),mainType:"Error",data:e,pageInfo:{pageWidth:document.body.clientWidth,pageHeight:document.body.clientHeight,screenWidth:window.screen.width,screenHeight:window.screen.height},currentUrl:window.location.href,refererUrl:document.referrer});u.db.add("error",d)},!0)},function(n){},function(n){},function(n){},function(n){}].forEach(function(n){n(h)}),i("[ MonitorSDK ]","Starting Monitor")});
